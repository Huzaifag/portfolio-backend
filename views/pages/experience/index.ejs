<% layout('layouts/layout') -%>

    <% block('header', true) %>
        <% block('sidebar', true) %>
<div class="max-w-5xl mx-auto mt-10">
  <div class="flex items-center justify-between mb-6">
    <h1 class="text-2xl font-bold text-gray-800 flex items-center">
    <i class="fas fa-briefcase mr-2 text-indigo-600"></i> Experience List
    </h1>
    <a href="/experience/create" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
    <i class="fas fa-plus mr-2"></i> Add New
    </a>
  </div>

  <!-- Filter/Search -->
  <div class="mb-4">
    <input type="text" id="filterInput" placeholder="Filter by title or company..." class="w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" onkeyup="filterTable()">
  </div>

  <div class="bg-white rounded-lg shadow">
    <table class="min-w-full divide-y divide-gray-200" id="infoTable">
      <thead class="bg-gray-50">
        <tr>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Title</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Company</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Duration</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y divide-gray-200">
        <% if (experiences && experiences.length) { %>
        <% experiences.forEach(exp => { %>
        <tr>
        <td class="px-6 py-4 whitespace-nowrap"><%= exp.title %></td>
        <td class="px-6 py-4 whitespace-nowrap"><%= exp.company %></td>
        <td class="px-6 py-4 whitespace-nowrap"><%= exp.duration %></td>
        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
        <a href="/experience/<%= exp._id %>" class="text-indigo-600 hover:text-indigo-900 mr-3">Show</a>
        <a href="/experience/<%= exp._id %>/edit" class="text-yellow-600 hover:text-yellow-900 mr-3">Edit</a>
        <form action="/experience/<%= exp._id %>/delete" method="POST" style="display:inline">
          <button type="submit" class="text-red-600 hover:text-red-900">Delete</button>
        </form>
        </td>
        </tr>
        <% }) %>
        <% } else { %>
        <tr><td colspan="4" class="px-6 py-4 text-center text-gray-500">No experiences found.</td></tr>
        <% } %>
      </tbody>
    </table>
  </div>
</div>

<script>
function filterTable() {
  var input, filter, table, tr, td, i, txtValue;
  input = document.getElementById("filterInput");
  filter = input.value.toUpperCase();
  table = document.getElementById("infoTable");
  tr = table.getElementsByTagName("tr");
  for (i = 1; i < tr.length; i++) {
    let show = false;
    let tds = tr[i].getElementsByTagName("td");
    for (let j = 0; j < 2; j++) {
      if (tds[j]) {
        txtValue = tds[j].textContent || tds[j].innerText;
        if (txtValue.toUpperCase().indexOf(filter) > -1) {
          show = true;
        }
      }
    }
    tr[i].style.display = show ? "" : "none";
  }
}
</script>
