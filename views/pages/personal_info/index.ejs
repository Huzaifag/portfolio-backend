<% layout('layouts/layout') -%>

    <% block('header', true) %>
        <% block('sidebar', true) %>
<div class="max-w-5xl mx-auto mt-10">
	<div class="flex items-center justify-between mb-6">
		<h1 class="text-2xl font-bold text-gray-800 flex items-center">
			<i class="fas fa-user mr-2 text-indigo-600"></i> Personal Info List
		</h1>
		<a href="/personal-info/new" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
			<i class="fas fa-plus mr-2"></i> Add New
		</a>
	</div>

	<!-- Filter/Search -->
	<div class="mb-4">
		<input type="text" id="filterInput" placeholder="Filter by name or title..." class="w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" onkeyup="filterTable()">
	</div>

	<div class="bg-white rounded-lg shadow">
		<table class="min-w-full divide-y divide-gray-200" id="infoTable">
			<thead class="bg-gray-50">
				<tr>
					<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
					<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Title</th>
					<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Summary</th>
					<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
				</tr>
			</thead>
			<tbody class="bg-white divide-y divide-gray-200">
				<% if (infos && infos.length) { %>
					<% infos.forEach(info => { %>
						<tr>
							<td class="px-6 py-4 whitespace-nowrap"><%= info.name %></td>
							<td class="px-6 py-4 whitespace-nowrap"><%= info.title %></td>
							<td class="px-6 py-4 whitespace-nowrap max-w-xs truncate" title="<%= info.summary %>">
								<%= info.summary.length > 40 ? info.summary.substring(0, 40) + '...' : info.summary %>
							</td>
							<td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
								<a href="/personal-info/<%= info._id %>" class="text-indigo-600 hover:text-indigo-900 mr-3">Show</a>
								<a href="/personal-info/<%= info._id %>/edit" class="text-yellow-600 hover:text-yellow-900 mr-3">Edit</a>
								<form action="/personal-info/<%= info._id %>/delete" method="POST" style="display:inline">
									<button type="submit" class="text-red-600 hover:text-red-900" onclick="return confirm('Delete this info?')">Delete</button>
								</form>
							</td>
						</tr>
					<% }) %>
				<% } else { %>
					<tr><td colspan="4" class="px-6 py-4 text-center text-gray-500">No personal info found.</td></tr>
				<% } %>
			</tbody>
		</table>
	</div>
</div>

<script>
	function filterTable() {
		var input = document.getElementById('filterInput');
		var filter = input.value.toLowerCase();
		var table = document.getElementById('infoTable');
		var trs = table.getElementsByTagName('tr');
		for (var i = 1; i < trs.length; i++) {
			var tds = trs[i].getElementsByTagName('td');
			if (tds.length > 1) {
				var name = tds[0].textContent.toLowerCase();
				var title = tds[1].textContent.toLowerCase();
				if (name.indexOf(filter) > -1 || title.indexOf(filter) > -1) {
					trs[i].style.display = '';
				} else {
					trs[i].style.display = 'none';
				}
			}
		}
	}
</script>
        

